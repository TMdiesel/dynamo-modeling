# å®Ÿè£…è¨ˆç”»æ›¸

**ç›®æ¬¡ã¯è‡ªå‹•ç”Ÿæˆãªã®ã§ç·¨é›†ã—ãªã„**

- [å®Ÿè£…è¨ˆç”»æ›¸](#å®Ÿè£…è¨ˆç”»æ›¸)
  - [æ¦‚è¦](#æ¦‚è¦)
  - [å®Ÿè£…æ–¹é‡](#å®Ÿè£…æ–¹é‡)
    - [åŸºæœ¬æ–¹é‡](#åŸºæœ¬æ–¹é‡)
    - [ğŸ“Š Sprint 3.2 å®Œäº†ã‚µãƒãƒªãƒ¼](#-sprint-32-å®Œäº†ã‚µãƒãƒªãƒ¼)
    - [ğŸš¨ **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»å†ªç­‰æ€§ãƒ»ãƒªãƒˆãƒ©ã‚¤èª²é¡Œåˆ†æ**](#-ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å†ªç­‰æ€§ãƒªãƒˆãƒ©ã‚¤èª²é¡Œåˆ†æ)
      - [1. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®èª²é¡Œ**](#1-ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®èª²é¡Œ)
      - [2. **å†ªç­‰æ€§ã®èª²é¡Œ**](#2-å†ªç­‰æ€§ã®èª²é¡Œ)
      - [3. **ãƒªãƒˆãƒ©ã‚¤å®‰å…¨æ€§ã®èª²é¡Œ**](#3-ãƒªãƒˆãƒ©ã‚¤å®‰å…¨æ€§ã®èª²é¡Œ)
      - [4. **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•Œã®å•é¡Œ**](#4-ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•Œã®å•é¡Œ)
      - [5. **å…·ä½“çš„ãªæ”¹å–„ãƒ—ãƒ©ãƒ³**](#5-å…·ä½“çš„ãªæ”¹å–„ãƒ—ãƒ©ãƒ³)
      - [6. **Phase 4 ã§ã®æ”¹å–„é …ç›®**](#6-phase-4-ã§ã®æ”¹å–„é …ç›®)
      - [7. **E2E ãƒ†ã‚¹ãƒˆã§ç™ºè¦‹ã•ã‚ŒãŸå…·ä½“çš„ãªå•é¡Œ**](#7-e2e-ãƒ†ã‚¹ãƒˆã§ç™ºè¦‹ã•ã‚ŒãŸå…·ä½“çš„ãªå•é¡Œ)
      - [8. **ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã®æ‹¡å¼µ**](#8-ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã®æ‹¡å¼µ)
      - [9. **å„ªå…ˆåº¦ã®é«˜ã„ä¿®æ­£é …ç›®ï¼ˆPhase 4 ã§å¿…é ˆï¼‰**](#9-å„ªå…ˆåº¦ã®é«˜ã„ä¿®æ­£é …ç›®phase-4-ã§å¿…é ˆ)
      - [10. **å®Ÿè£…ã®å‰ææ¡ä»¶ã¨åˆ¶ç´„**](#10-å®Ÿè£…ã®å‰ææ¡ä»¶ã¨åˆ¶ç´„)
      - [12. **ãƒªã‚¹ã‚¯ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆï¼ˆPhase 4ï¼‰**](#12-ãƒªã‚¹ã‚¯ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆphase-4)
      - [13. **æŠ€è¡“çš„è² å‚µã®ç®¡ç†**](#13-æŠ€è¡“çš„è² å‚µã®ç®¡ç†)
      - [14. **å“è³ªã‚²ãƒ¼ãƒˆã®å®šç¾©**](#14-å“è³ªã‚²ãƒ¼ãƒˆã®å®šç¾©)
      - [11. **Phase 4 ã§ã®æŠ€è¡“çš„åˆ¤æ–­åŸºæº–**](#11-phase-4-ã§ã®æŠ€è¡“çš„åˆ¤æ–­åŸºæº–)
  - [Phase 1: Foundationï¼ˆç›®æ¨™æœŸé–“: 1 é€±é–“ï¼‰](#phase-1-foundationç›®æ¨™æœŸé–“-1-é€±é–“)
    - [ğŸ¯ ç›®æ¨™](#-ç›®æ¨™)
    - [Sprint 1.1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ï¼ˆ2 æ—¥ç›®æ¨™ï¼‰](#sprint-11-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–2-æ—¥ç›®æ¨™)
      - [Day 1: ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#day-1-ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—)
      - [Day 2: DynamoDB æ¥ç¶šç¢ºèª](#day-2-dynamodb-æ¥ç¶šç¢ºèª)
    - [Sprint 1.2: ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤å®Ÿè£…ï¼ˆ3 æ—¥ç›®æ¨™ï¼‰](#sprint-12-ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤å®Ÿè£…3-æ—¥ç›®æ¨™)
      - [Day 3: å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå®Ÿè£…](#day-3-å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå®Ÿè£…)
      - [Day 4: ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®Ÿè£…](#day-4-ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®Ÿè£…)
      - [Day 5: ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹](#day-5-ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹)
  - [Phase 2: Infrastructureï¼ˆç›®æ¨™æœŸé–“: 1 é€±é–“ï¼‰](#phase-2-infrastructureç›®æ¨™æœŸé–“-1-é€±é–“)
    - [ğŸ¯ ç›®æ¨™](#-ç›®æ¨™-1)
    - [Sprint 2.1: DynamoDB ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆ2 æ—¥ç›®æ¨™ï¼‰](#sprint-21-dynamodb-ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—2-æ—¥ç›®æ¨™)
      - [Day 6: ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆå®Ÿè£…](#day-6-ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆå®Ÿè£…)
      - [Day 7: AWS SDK è¨­å®š](#day-7-aws-sdk-è¨­å®š)
    - [Sprint 2.2: ãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…ï¼ˆ3 æ—¥ç›®æ¨™ï¼‰](#sprint-22-ãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…3-æ—¥ç›®æ¨™)
      - [Day 8: ãƒ‡ãƒ¼ã‚¿ãƒãƒƒãƒ‘ãƒ¼å®Ÿè£…](#day-8-ãƒ‡ãƒ¼ã‚¿ãƒãƒƒãƒ‘ãƒ¼å®Ÿè£…)
      - [Day 9: Customer ãƒªãƒã‚¸ãƒˆãƒª](#day-9-customer-ãƒªãƒã‚¸ãƒˆãƒª)
      - [Day 10: Product/Order ãƒªãƒã‚¸ãƒˆãƒª](#day-10-productorder-ãƒªãƒã‚¸ãƒˆãƒª)
  - [Phase 3: API Layerï¼ˆç›®æ¨™æœŸé–“: 1 é€±é–“ï¼‰](#phase-3-api-layerç›®æ¨™æœŸé–“-1-é€±é–“)
    - [ğŸ¯ ç›®æ¨™](#-ç›®æ¨™-2)
    - [Sprint 3.1: OpenAPI \& åŸºæœ¬ APIï¼ˆ2 æ—¥ç›®æ¨™ï¼‰](#sprint-31-openapi--åŸºæœ¬-api2-æ—¥ç›®æ¨™)
      - [Day 11: OpenAPI ä»•æ§˜å®šç¾©](#day-11-openapi-ä»•æ§˜å®šç¾©)
      - [Day 12: åŸºæœ¬ CRUD API](#day-12-åŸºæœ¬-crud-api)
    - [Sprint 3.2: æ¥­å‹™ APIï¼ˆ3 æ—¥ç›®æ¨™ï¼‰](#sprint-32-æ¥­å‹™-api3-æ—¥ç›®æ¨™)
      - [Day 13: ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤å®Ÿè£…](#day-13-ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤å®Ÿè£…)
      - [Day 14: æ³¨æ–‡æ©Ÿèƒ½å®Ÿè£…](#day-14-æ³¨æ–‡æ©Ÿèƒ½å®Ÿè£…)
      - [Day 15: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»E2E ãƒ†ã‚¹ãƒˆ](#day-15-ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°e2e-ãƒ†ã‚¹ãƒˆ)
  - [Phase 4: Quality \& Documentationï¼ˆç›®æ¨™æœŸé–“: 3 æ—¥ï¼‰](#phase-4-quality--documentationç›®æ¨™æœŸé–“-3-æ—¥)
    - [ğŸ¯ ç›®æ¨™](#-ç›®æ¨™-3)
      - [é‡è¦: ç¾åœ¨ã®å„ªå…ˆé †ä½](#é‡è¦-ç¾åœ¨ã®å„ªå…ˆé †ä½)
    - [ğŸ“Š Sprint 4.1: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»å†ªç­‰æ€§æ”¹å–„ï¼ˆ3 æ—¥ï¼‰](#-sprint-41-ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å†ªç­‰æ€§æ”¹å–„3-æ—¥)
      - [Day 15: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°çµ±ä¸€åŒ–](#day-15-ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°çµ±ä¸€åŒ–)
      - [Day 16: å†ªç­‰æ€§ãƒ»ãƒªãƒˆãƒ©ã‚¤å®Ÿè£…](#day-16-å†ªç­‰æ€§ãƒªãƒˆãƒ©ã‚¤å®Ÿè£…)
      - [Day 17: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ»ãƒ†ã‚¹ãƒˆå¼·åŒ–](#day-17-ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆå¼·åŒ–)
    - [ğŸ“Š Sprint 3.1 å®Œäº†ã‚µãƒãƒªãƒ¼](#-sprint-31-å®Œäº†ã‚µãƒãƒªãƒ¼)
    - [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ç¢ºå®š](#æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ç¢ºå®š)
  - [é€²æ—ç®¡ç†](#é€²æ—ç®¡ç†)
    - [ãƒ‡ã‚¤ãƒªãƒ¼ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ](#ãƒ‡ã‚¤ãƒªãƒ¼ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ)
    - [ã‚¦ã‚£ãƒ¼ã‚¯ãƒªãƒ¼ãƒ¬ãƒ“ãƒ¥ãƒ¼](#ã‚¦ã‚£ãƒ¼ã‚¯ãƒªãƒ¼ãƒ¬ãƒ“ãƒ¥ãƒ¼)
    - [å®Œäº†æ¡ä»¶](#å®Œäº†æ¡ä»¶)
  - [ç·Šæ€¥æ™‚å¯¾å¿œ](#ç·Šæ€¥æ™‚å¯¾å¿œ)
    - [ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é…å»¶æ™‚](#ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é…å»¶æ™‚)
    - [æŠ€è¡“çš„èª²é¡Œç™ºç”Ÿæ™‚](#æŠ€è¡“çš„èª²é¡Œç™ºç”Ÿæ™‚)
    - [ãƒªã‚½ãƒ¼ã‚¹ä¸è¶³æ™‚](#ãƒªã‚½ãƒ¼ã‚¹ä¸è¶³æ™‚)
  - [æ‹¡å¼µå€™è£œãƒ‰ãƒ¡ã‚¤ãƒ³](#æ‹¡å¼µå€™è£œãƒ‰ãƒ¡ã‚¤ãƒ³)
    - [Phase 5: åœ¨åº«ãƒ»é…é€ãƒ»æ±ºæ¸ˆæ‹¡å¼µï¼ˆç›®æ¨™æœŸé–“: 1 é€±é–“ï¼‰](#phase-5-åœ¨åº«é…é€æ±ºæ¸ˆæ‹¡å¼µç›®æ¨™æœŸé–“-1-é€±é–“)
      - [Warehouseï¼ˆå€‰åº«ãƒ»åœ¨åº«ç®¡ç†ï¼‰](#warehouseå€‰åº«åœ¨åº«ç®¡ç†)
      - [Shipmentï¼ˆé…é€ç®¡ç†ï¼‰](#shipmenté…é€ç®¡ç†)
      - [Paymentï¼ˆæ±ºæ¸ˆç®¡ç†ï¼‰](#paymentæ±ºæ¸ˆç®¡ç†)
    - [Phase 5 å®Ÿè£…é †åº](#phase-5-å®Ÿè£…é †åº)
      - [Sprint 5.1: Warehouse ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆ2 æ—¥ï¼‰](#sprint-51-warehouse-ãƒ‰ãƒ¡ã‚¤ãƒ³2-æ—¥)
      - [Sprint 5.2: Payment ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆ2 æ—¥ï¼‰](#sprint-52-payment-ãƒ‰ãƒ¡ã‚¤ãƒ³2-æ—¥)
      - [Sprint 5.3: Shipment ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆ2 æ—¥ï¼‰](#sprint-53-shipment-ãƒ‰ãƒ¡ã‚¤ãƒ³2-æ—¥)
      - [Sprint 5.4: ãƒ‰ãƒ¡ã‚¤ãƒ³çµ±åˆï¼ˆ1 æ—¥ï¼‰](#sprint-54-ãƒ‰ãƒ¡ã‚¤ãƒ³çµ±åˆ1-æ—¥)
  - [ãƒ†ã‚¹ãƒˆæˆ¦ç•¥](#ãƒ†ã‚¹ãƒˆæˆ¦ç•¥)
    - [ç¾çŠ¶ã®èª²é¡Œã¨æ”¹å–„æ–¹é‡](#ç¾çŠ¶ã®èª²é¡Œã¨æ”¹å–„æ–¹é‡)
      - [~~1. inmemory ãƒªãƒã‚¸ãƒˆãƒªã®é…ç½®å•é¡Œ~~ â†’ è§£æ±ºæ¸ˆã¿](#1-inmemory-ãƒªãƒã‚¸ãƒˆãƒªã®é…ç½®å•é¡Œ--è§£æ±ºæ¸ˆã¿)
      - [1. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œç’°å¢ƒã®çµ±ä¸€ âœ…](#1-ãƒ†ã‚¹ãƒˆå®Ÿè¡Œç’°å¢ƒã®çµ±ä¸€-)
      - [3. ãƒ†ã‚¹ãƒˆã®ãƒ”ãƒ©ãƒŸãƒƒãƒ‰æ§‹é€ ](#3-ãƒ†ã‚¹ãƒˆã®ãƒ”ãƒ©ãƒŸãƒƒãƒ‰æ§‹é€ )
      - [2. ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã®å®Ÿè£…](#2-ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã®å®Ÿè£…)
    - [ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“ã®ç›®æ¨™](#ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“ã®ç›®æ¨™)
    - [ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™](#ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™)

## æ¦‚è¦

DynamoDB ã¨ Clean Architecture ã‚’çµ„ã¿åˆã‚ã›ãŸã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚·ãƒ§ãƒƒãƒ— API ã®æ®µéšçš„å®Ÿè£…è¨ˆç”»

## å®Ÿè£…æ–¹é‡

### åŸºæœ¬æ–¹é‡

1. **ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º**: Red â†’ Green â†’ Refactor ã‚µã‚¤ã‚¯ãƒ«
2. **æ®µéšçš„å®Ÿè£…**: æœ€å°å˜ä½ã‹ã‚‰å¾ã€…ã«æ©Ÿèƒ½æ‹¡å¼µ
3. **å‹å®‰å…¨æ€§é‡è¦–**: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã‚¨- [x] **Task 2.2.8**: å…¨ãƒªãƒã‚¸ãƒˆãƒªã®çµ±åˆãƒ†ã‚¹ãƒˆ

```go
// integration_test.go ã§ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆå®Ÿè£…æ¸ˆã¿
// Customerç™»éŒ² â†’ Productä½œæˆ â†’ Orderä½œæˆã®ä¸€é€£ãƒ•ãƒ­ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆ
// ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆ20ä»¶ä¸€æ‹¬æ“ä½œã€225mså®Œäº†ï¼‰å®Ÿè£…æ¸ˆã¿
// å…¨ãƒ†ã‚¹ãƒˆPASS: ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰(0.02s) + ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹(0.23s)
```

**ğŸ¯ ç¾åœ¨åœ°**: Sprint 3.2 å®Œäº†ï¼ Clean Architecture å®Ÿè£…ãŒå…¨ãƒ‰ãƒ¡ã‚¤ãƒ³ã§å®Œäº† ğŸŠ

### ğŸ“Š Sprint 3.2 å®Œäº†ã‚µãƒãƒªãƒ¼

**Clean Architecture å®Ÿè£…å®Œäº†**:

- âœ… Customer Domain: Handler â†’ Controller â†’ UseCase â†’ Repository â†’ Entity
- âœ… Product Domain: Handler â†’ Controller â†’ UseCase â†’ Repository â†’ Entity
- âœ… Order Domain: Handler â†’ Controller â†’ UseCase â†’ Repository â†’ Entity
- âœ… å…¨ Repository Interface å®Œå…¨å®Ÿè£…ï¼ˆFindByStatus, FindInStock ç­‰ï¼‰
- âœ… Entity State Management ä¿®æ­£ï¼ˆNewOrderWithState ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ï¼‰
- âœ… Order Status æ›´æ–°ã®æ°¸ç¶šåŒ–å•é¡Œè§£æ±º
- âœ… åœ¨åº«ç®¡ç†ãƒ»æ³¨æ–‡ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè£…
- âœ… æ§‹é€ åŒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- âœ… å®Œå…¨ãªä¾å­˜æ€§æ³¨å…¥ (main.go)

**E2E ãƒ†ã‚¹ãƒˆå®Ÿè£…å®Œäº†**:

- âœ… å®Ÿéš›ã® HTTP ã‚µãƒ¼ãƒãƒ¼ã«å¯¾ã™ã‚‹ End-to-End ãƒ†ã‚¹ãƒˆå®Ÿè£…
- âœ… æ­£å¸¸ã‚·ãƒŠãƒªã‚ª: é¡§å®¢ç™»éŒ² â†’ å•†å“ä½œæˆ â†’ æ³¨æ–‡ä½œæˆ â†’ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
- âœ… ã‚¨ãƒ©ãƒ¼ã‚·ãƒŠãƒªã‚ª: åœ¨åº«ä¸è¶³ã€å­˜åœ¨ã—ãªã„é¡§å®¢ã§ã®æ³¨æ–‡ã‚¨ãƒ©ãƒ¼
- âœ… ä¸¦è¡Œå‡¦ç†ã‚·ãƒŠãƒªã‚ª: è¤‡æ•°ã®ä¸¦è¡Œæ³¨æ–‡ã§ã®åœ¨åº«ç«¶åˆãƒ†ã‚¹ãƒˆ
- âœ… æ³¨æ–‡ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«: pending â†’ confirmed â†’ shipped â†’ delivered

**API å‹•ä½œç¢ºèª**:

```bash
# å…¨ãƒ‰ãƒ¡ã‚¤ãƒ³CRUDå‹•ä½œç¢ºèªæ¸ˆã¿
POST /customers â†’ Customerä½œæˆ âœ…
GET /customers/{id} â†’ Customerå–å¾— âœ…
POST /products â†’ Productä½œæˆ âœ…
GET /products/{id} â†’ Productå–å¾— âœ…
POST /orders â†’ Orderä½œæˆï¼ˆåœ¨åº«æ¸›å°‘ç¢ºèªï¼‰ âœ…
PUT /orders/{id} â†’ Order Statusæ›´æ–° âœ…
# Order: pending â†’ confirmed â†’ shipped ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç¢ºèªæ¸ˆã¿
```

**âš ï¸ ç™ºè¦‹ã•ã‚ŒãŸèª²é¡Œ**:

1. **åœ¨åº«ç®¡ç†ã®ç«¶åˆåˆ¶å¾¡å•é¡Œ**:

   - ä¸¦è¡Œæ³¨æ–‡ãƒ†ã‚¹ãƒˆã§ 3 ã¤ã®æ³¨æ–‡ãŒå…¨ã¦æˆåŠŸï¼ˆæœ¬æ¥ã¯ 1 ã¤ã®ã¿æˆåŠŸã™ã¹ãï¼‰
   - DynamoDB ã® ConditionExpression ã«ã‚ˆã‚‹æ¥½è¦³çš„ãƒ­ãƒƒã‚¯ãŒæœªå®Ÿè£…
   - åœ¨åº«æ•°ã®æ•´åˆæ€§ãŒä¿è¨¼ã•ã‚Œã¦ã„ãªã„çŠ¶æ…‹

2. **ç«¶åˆåˆ¶å¾¡ã®å®Ÿè£…ãŒå¿…è¦ãªç®‡æ‰€**:

   ```go
   // ProductRepository.UpdateStock ã§ ConditionExpression å¿…è¦
   // ä¾‹: "stock >= :quantity" ã§åœ¨åº«ãŒååˆ†ãªå ´åˆã®ã¿æ›´æ–°

   // OrderRepository.Save ã§ã¹ãç­‰æ€§ä¿è¨¼ãŒå¿…è¦
   // ä¾‹: OrderIDã®é‡è¤‡ãƒã‚§ãƒƒã‚¯
   ```

3. **ä»Šå¾Œã®æ”¹å–„æ–¹é‡**:
   - DynamoDB ã® Conditional Writes ã‚’æ´»ç”¨ã—ãŸåœ¨åº«ç®¡ç†å®Ÿè£…
   - ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã®æ¤œè¨ï¼ˆDynamoDB Transactionsï¼‰
   - åœ¨åº«ç¢ºä¿ â†’ æ³¨æ–‡ç¢ºå®šã® 2 æ®µéšã‚³ãƒŸãƒƒãƒˆå®Ÿè£…

### ğŸš¨ **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»å†ªç­‰æ€§ãƒ»ãƒªãƒˆãƒ©ã‚¤èª²é¡Œåˆ†æ**

#### 1. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®èª²é¡Œ**

**ç¾çŠ¶ã®å•é¡Œ**:

- ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ã¯æ§‹é€ åŒ–ã•ã‚Œã¦ã„ã‚‹ãŒã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚¨ãƒ©ãƒ¼ã¨ã®æ··åœ¨ãŒç™ºç”Ÿ
- HTTP ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ã®å¯¾å¿œãŒä¸å®Œå…¨
- ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®çµ±ä¸€æ€§ãŒä¸ååˆ†

**å…·ä½“çš„ãªå•é¡Œç®‡æ‰€**:

```go
// ç¾åœ¨ã®å•é¡Œ: ã‚¨ãƒ©ãƒ¼åˆ†é¡ãŒæ›–æ˜§
func (c *OrderController) CreateOrder(ctx echo.Context) error {
    order, err := c.createOrderUseCase.Execute(context.Background(), command)
    if err != nil {
        // å…¨ã¦ã®ã‚¨ãƒ©ãƒ¼ã‚’400 BadRequestã§è¿”ã—ã¦ã„ã‚‹
        return c.presenter.PresentError(ctx, http.StatusBadRequest, "creation_failed", err.Error())
    }
}

// æ”¹å–„ã™ã¹ãç‚¹: ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸé©åˆ‡ãªHTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
// - CUSTOMER_NOT_FOUND â†’ 404 Not Found
// - INSUFFICIENT_STOCK â†’ 409 Conflict
// - REPOSITORY_ERROR â†’ 500 Internal Server Error
```

#### 2. **å†ªç­‰æ€§ã®èª²é¡Œ**

**ç¾çŠ¶ã®å•é¡Œ**:

- Order ä½œæˆãŒéå†ªç­‰ï¼ˆåŒã˜ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§è¤‡æ•°å›å®Ÿè¡Œã™ã‚‹ã¨é‡è¤‡æ³¨æ–‡ãŒç™ºç”Ÿï¼‰
- Customer ä½œæˆã§ Email é‡è¤‡ãƒã‚§ãƒƒã‚¯ã¯ã‚ã‚‹ãŒã€ç«¶åˆæ™‚ã®å‡¦ç†ãŒä¸å®Œå…¨
- Product åœ¨åº«æ›´æ–°ãŒéå†ªç­‰ï¼ˆåŒæ™‚æ›´æ–°ã§æ•´åˆæ€§ãŒå´©ã‚Œã‚‹ï¼‰

**å†ªç­‰æ€§ãŒå¿…è¦ãªæ“ä½œ**:

```go
// Orderä½œæˆã®å†ªç­‰æ€§å®Ÿè£…ãŒå¿…è¦
type CreateOrderUseCase struct {
    // Idempotency Keyã‚’å—ã‘å–ã‚‹ä»•çµ„ã¿ãŒå¿…è¦
}

// å®Ÿè£…ã™ã¹ãå†ªç­‰æ€§ãƒ‘ã‚¿ãƒ¼ãƒ³:
// 1. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæŒ‡å®šã®Idempotency Key
// 2. ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒãƒƒã‚·ãƒ¥ãƒ™ãƒ¼ã‚¹ã®é‡è¤‡æ¤œçŸ¥
// 3. æ“ä½œçµæœã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆ24æ™‚é–“ï¼‰
```

#### 3. **ãƒªãƒˆãƒ©ã‚¤å®‰å…¨æ€§ã®èª²é¡Œ**

**ç¾çŠ¶ã®å•é¡Œ**:

- DynamoDB æ¥ç¶šã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒªãƒˆãƒ©ã‚¤ãŒå±é™ºï¼ˆåœ¨åº«ã®äºŒé‡æ¸›ç®—ãƒªã‚¹ã‚¯ï¼‰
- éƒ¨åˆ†çš„ãªæˆåŠŸçŠ¶æ…‹ã‹ã‚‰ã®å¾©æ—§å‡¦ç†ãŒãªã„
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‡¦ç†ãŒä¸ååˆ†

**ãƒªãƒˆãƒ©ã‚¤å¯èƒ½ vs ä¸å¯èƒ½ãªæ“ä½œ**:

```go
// ãƒªãƒˆãƒ©ã‚¤å®‰å…¨ï¼ˆå†ªç­‰ï¼‰
func (r *Repository) FindByID(ctx context.Context, id ID) error {
    // èª­ã¿å–ã‚Šæ“ä½œï¼šä½•åº¦å®Ÿè¡Œã—ã¦ã‚‚åŒã˜çµæœ
}

// ãƒªãƒˆãƒ©ã‚¤å±é™ºï¼ˆéå†ªç­‰ï¼‰
func (uc *CreateOrderUseCase) Execute(ctx context.Context, cmd Command) error {
    // 1. åœ¨åº«ç¢ºèª â† ãƒªãƒˆãƒ©ã‚¤å®‰å…¨
    // 2. åœ¨åº«æ¸›ç®— â† ãƒªãƒˆãƒ©ã‚¤å±é™ºï¼ˆConditionExpressionæœªå®Ÿè£…ï¼‰
    // 3. æ³¨æ–‡ä¿å­˜ â† ãƒªãƒˆãƒ©ã‚¤å±é™ºï¼ˆé‡è¤‡ãƒã‚§ãƒƒã‚¯æœªå®Ÿè£…ï¼‰
}
```

#### 4. **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•Œã®å•é¡Œ**

**ç¾çŠ¶ã®å•é¡Œ**:

- æ³¨æ–‡ä½œæˆã§ã€Œåœ¨åº«æ¸›ç®—ã€â†’ã€Œæ³¨æ–‡ä¿å­˜ã€ãŒåˆ†é›¢ã•ã‚Œã¦ãŠã‚Šã€ä¸­é–“å¤±æ•—çŠ¶æ…‹ãŒç™ºç”Ÿå¯èƒ½
- ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ãŒæœªå®Ÿè£…
- éƒ¨åˆ†çš„æˆåŠŸã‹ã‚‰ã®å¾©æ—§ãƒ­ã‚¸ãƒƒã‚¯ãŒãªã„

**æ”¹å–„ãŒå¿…è¦ãªãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³**:

```go
// å•é¡Œã®ã‚ã‚‹ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•Œ
func (uc *CreateOrderUseCase) Execute(ctx context.Context, cmd CreateOrderCommand) (*entity.Order, error) {
    // ã“ã“ã§å¤±æ•—ã™ã‚‹ã¨åœ¨åº«ã ã‘æ¸›ã£ã¦æ³¨æ–‡ãŒä¿å­˜ã•ã‚Œãªã„
    for _, item := range cmd.Items {
        product.ReserveStock(item.Quantity) // â†ã€å±é™ºã€‘
        uc.productRepo.Save(ctx, product)   // â†ã€å±é™ºã€‘
    }

    // ã“ã“ã§å¤±æ•—ã™ã‚‹ã¨åœ¨åº«ã¯æ¸›ã£ãŸãŒæ³¨æ–‡ãŒä½œæˆã•ã‚Œãªã„çŠ¶æ…‹
    err := uc.orderRepo.Save(ctx, order)   // â†ã€å±é™ºã€‘
    if err != nil {
        // ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ãŒæœªå®Ÿè£… â†ã€å•é¡Œã€‘
        return nil, err
    }
}
```

#### 5. **å…·ä½“çš„ãªæ”¹å–„ãƒ—ãƒ©ãƒ³**

**Phase 4.1: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ”¹å–„ï¼ˆ1 æ—¥ï¼‰**

```go
// 1. æ§‹é€ åŒ–ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹
type APIError struct {
    Code       string            `json:"code"`
    Message    string            `json:"message"`
    Details    map[string]string `json:"details,omitempty"`
    RetryAfter *int             `json:"retry_after,omitempty"`
}

// 2. ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ—åˆ¥HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
func (c *Controller) mapDomainErrorToHTTP(err error) (int, APIError) {
    switch {
    case isDomainError(err, "NOT_FOUND"):
        return http.StatusNotFound, APIError{...}
    case isDomainError(err, "INSUFFICIENT_STOCK"):
        return http.StatusConflict, APIError{...}
    case isDomainError(err, "VALIDATION_ERROR"):
        return http.StatusBadRequest, APIError{...}
    default:
        return http.StatusInternalServerError, APIError{...}
    }
}
```

**Phase 4.2: å†ªç­‰æ€§å®Ÿè£…ï¼ˆ1 æ—¥ï¼‰**

```go
// 1. Idempotency Keyæ©Ÿèƒ½
type IdempotencyService interface {
    IsProcessed(ctx context.Context, key string) (bool, interface{}, error)
    StoreResult(ctx context.Context, key string, result interface{}) error
}

// 2. æ³¨æ–‡ä½œæˆã®å†ªç­‰æ€§
func (uc *CreateOrderUseCase) Execute(ctx context.Context, cmd CreateOrderCommand) (*entity.Order, error) {
    // ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæŒ‡å®šã¾ãŸã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒãƒƒã‚·ãƒ¥ãƒ™ãƒ¼ã‚¹ã®ã‚­ãƒ¼
    idempotencyKey := cmd.IdempotencyKey
    if idempotencyKey == "" {
        idempotencyKey = generateHash(cmd)
    }

    // æ—¢ã«å‡¦ç†æ¸ˆã¿ã‹ãƒã‚§ãƒƒã‚¯
    if processed, result, _ := uc.idempotency.IsProcessed(ctx, idempotencyKey); processed {
        return result.(*entity.Order), nil
    }

    // å®Ÿéš›ã®å‡¦ç†...
}
```

**Phase 4.3: ç«¶åˆåˆ¶å¾¡å®Ÿè£…ï¼ˆ1 æ—¥ï¼‰**

```go
// 1. DynamoDB Conditional Writes
func (r *DynamoProductRepository) Save(ctx context.Context, product *entity.Product) error {
    item := ProductToItem(product)

    // æ¥½è¦³çš„ãƒ­ãƒƒã‚¯ï¼šç¾åœ¨ã®åœ¨åº«æ•°ãŒæœŸå¾…å€¤ã¨ä¸€è‡´ã™ã‚‹å ´åˆã®ã¿æ›´æ–°
    condition := expression.Name("Stock").Equal(expression.Value(product.PreviousStock()))

    err := r.table.Put(item).If(condition).Run(ctx)
    if err != nil {
        if isConditionalCheckFailedException(err) {
            return domain.NewDomainError("CONCURRENT_MODIFICATION",
                "Product was modified by another request", err)
        }
        return err
    }
    return nil
}

// 2. DynamoDB Transactionsä½¿ç”¨
func (uc *CreateOrderUseCase) ExecuteWithTransaction(ctx context.Context, cmd CreateOrderCommand) error {
    // ã™ã¹ã¦ã®æ“ä½œã‚’å˜ä¸€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§å®Ÿè¡Œ
    transactionItems := []types.TransactWriteItem{
        // åœ¨åº«æ¸›ç®—ï¼ˆæ¡ä»¶ä»˜ãï¼‰
        {Update: &types.Update{...}},
        // æ³¨æ–‡ä¿å­˜
        {Put: &types.Put{...}},
    }

    _, err := r.client.TransactWriteItems(ctx, &dynamodb.TransactWriteItemsInput{
        TransactItems: transactionItems,
    })
    return err
}
```

#### 6. **Phase 4 ã§ã®æ”¹å–„é …ç›®**

- [ ] **Task 4.1.1**: æ§‹é€ åŒ–ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å®Ÿè£…
- [ ] **Task 4.1.2**: ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ—åˆ¥ HTTP ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒãƒ”ãƒ³ã‚°
- [ ] **Task 4.1.3**: ãƒªãƒˆãƒ©ã‚¤å¯èƒ½ã‚¨ãƒ©ãƒ¼ã®è­˜åˆ¥æ©Ÿèƒ½
- [ ] **Task 4.2.1**: Idempotency Key æ©Ÿèƒ½å®Ÿè£…
- [ ] **Task 4.2.2**: æ³¨æ–‡ä½œæˆã®å†ªç­‰æ€§å®Ÿè£…
- [ ] **Task 4.2.3**: é‡è¤‡å‡¦ç†æ¤œçŸ¥ãƒ»çµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥
- [ ] **Task 4.3.1**: DynamoDB Conditional Writes å®Ÿè£…
- [ ] **Task 4.3.2**: åœ¨åº«ç®¡ç†ã®ç«¶åˆåˆ¶å¾¡å®Ÿè£…
- [ ] **Task 4.3.3**: DynamoDB Transactions é©ç”¨
- [ ] **Task 4.4.1**: ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼å®Ÿè£…ï¼ˆåŸºæœ¬ï¼‰
- [ ] **Task 4.4.2**: ã‚¨ã‚¯ã‚¹ãƒãƒãƒ³ã‚·ãƒ£ãƒ«ãƒãƒƒã‚¯ã‚ªãƒ•ãƒªãƒˆãƒ©ã‚¤
- [ ] **Task 4.4.3**: éƒ¨åˆ†å¤±æ•—ã‹ã‚‰ã®å¾©æ—§ãƒ­ã‚¸ãƒƒã‚¯

#### 7. **E2E ãƒ†ã‚¹ãƒˆã§ç™ºè¦‹ã•ã‚ŒãŸå…·ä½“çš„ãªå•é¡Œ**

**ä¸¦è¡Œå‡¦ç†ã§ã®åœ¨åº«ç®¡ç†å•é¡Œ**:

E2E ãƒ†ã‚¹ãƒˆã® `TestE2E_ConcurrentOrders` ã§ä»¥ä¸‹ã®å•é¡ŒãŒç™ºè¦š:

- åœ¨åº« 5 å€‹ã®å•†å“ã«å¯¾ã—ã¦ã€3 ã¤ã®ä¸¦è¡Œæ³¨æ–‡ï¼ˆå„ 3 å€‹ï¼‰ãŒå…¨ã¦æˆåŠŸ
- ç†æƒ³çš„ã«ã¯ 1 ã¤ã®ã¿æˆåŠŸã—ã€æ®‹ã‚Š 2 ã¤ã¯åœ¨åº«ä¸è¶³ã‚¨ãƒ©ãƒ¼ã¨ãªã‚‹ã¹ã
- åœ¨åº«ãŒè² æ•°ï¼ˆ-4 å€‹ï¼‰ã«ãªã‚‹ç«¶åˆçŠ¶æ…‹ãŒç™ºç”Ÿ

```go
// å®Ÿéš›ã®å•é¡Œã‚³ãƒ¼ãƒ‰ï¼ˆinternal/usecase/order_usecase.goï¼‰
func (uc *CreateOrderUseCase) Execute(ctx context.Context, cmd CreateOrderCommand) (*entity.Order, error) {
    // åœ¨åº«ç¢ºèªï¼ˆæ™‚ç‚¹Aï¼‰
    product, _ := uc.productRepo.FindByID(ctx, productID)

    // åœ¨åº«äºˆç´„ï¼ˆæ™‚ç‚¹Bï¼‰- ã“ã®é–“ã«ä»–ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå‰²ã‚Šè¾¼ã¿å¯èƒ½
    err = product.ReserveStock(itemCmd.Quantity)
    if err != nil {
        return nil, domain.NewDomainError("STOCK_RESERVATION_FAILED", ...)
    }

    // åœ¨åº«æ›´æ–°ï¼ˆæ™‚ç‚¹Cï¼‰- æ¥½è¦³çš„ãƒ­ãƒƒã‚¯ãªã—ã§æ›´æ–°
    err = uc.productRepo.Save(ctx, product)
    // â†ã€å±é™ºã€‘: ä»–ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å¤‰æ›´ã‚’ä¸Šæ›¸ãã™ã‚‹å¯èƒ½æ€§
}
```

**HTTP ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã®ä¸çµ±ä¸€å•é¡Œ**:

```go
// ç¾åœ¨ã®å•é¡Œä¾‹
func (c *OrderController) CreateOrder(ctx echo.Context) error {
    order, err := c.createOrderUseCase.Execute(context.Background(), command)
    if err != nil {
        // å…¨ã¦ã®ã‚¨ãƒ©ãƒ¼ãŒ 400 BadRequest ã¨ã—ã¦è¿”ã•ã‚Œã‚‹
        return c.presenter.PresentError(ctx, http.StatusBadRequest, "creation_failed", err.Error())
    }
}

// æ”¹å–„ãŒå¿…è¦:
// - CUSTOMER_NOT_FOUND â†’ 404 Not Found
// - INSUFFICIENT_STOCK â†’ 409 Conflict
// - CONCURRENT_MODIFICATION â†’ 409 Conflict
// - VALIDATION_ERROR â†’ 400 Bad Request
// - REPOSITORY_ERROR â†’ 500 Internal Server Error
```

#### 8. **ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã®æ‹¡å¼µ**

```go
// ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®çµ±åˆãƒ†ã‚¹ãƒˆ
func TestErrorHandling_ConcurrentStockUpdate(t *testing.T) {
    // åŒæ™‚åœ¨åº«æ›´æ–°ã§Conflictã‚¨ãƒ©ãƒ¼ãŒé©åˆ‡ã«å‡¦ç†ã•ã‚Œã‚‹ã“ã¨ã‚’ãƒ†ã‚¹ãƒˆ
}

func TestIdempotency_DuplicateOrderCreation(t *testing.T) {
    // åŒã˜Idempotency Keyã§è¤‡æ•°å›ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¦ã‚‚åŒã˜çµæœãŒè¿”ã‚‹ã“ã¨ã‚’ãƒ†ã‚¹ãƒˆ
}

func TestRetry_PartialFailureRecovery(t *testing.T) {
    // éƒ¨åˆ†å¤±æ•—çŠ¶æ…‹ã‹ã‚‰ã®å¾©æ—§å‡¦ç†ã‚’ãƒ†ã‚¹ãƒˆ
}

func TestConcurrentStock_RaceCondition(t *testing.T) {
    // E2Eãƒ†ã‚¹ãƒˆã§ç™ºè¦‹ã•ã‚ŒãŸåœ¨åº«ç«¶åˆå•é¡Œã®å˜ä½“ãƒ†ã‚¹ãƒˆç‰ˆ
    // åœ¨åº«5å€‹ã«å¯¾ã—ã¦ä¸¦è¡Œæ³¨æ–‡3ã¤ï¼ˆå„3å€‹ï¼‰ã§é©åˆ‡ã«ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
}
```

#### 9. **å„ªå…ˆåº¦ã®é«˜ã„ä¿®æ­£é …ç›®ï¼ˆPhase 4 ã§å¿…é ˆï¼‰**

**ğŸš¨ Critical ãƒ¬ãƒ™ãƒ«ï¼ˆå¿…é ˆä¿®æ­£ï¼‰**:

1. **åœ¨åº«ç®¡ç†ã®ç«¶åˆåˆ¶å¾¡**

   - DynamoDB Conditional Writes ã«ã‚ˆã‚‹æ¥½è¦³çš„ãƒ­ãƒƒã‚¯å®Ÿè£…
   - ç†ç”±: E2E ãƒ†ã‚¹ãƒˆã§åœ¨åº«ãŒãƒã‚¤ãƒŠã‚¹ã«ãªã‚‹å•é¡Œã‚’ç™ºè¦‹

2. **æ§‹é€ åŒ–ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹**

   - ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ—åˆ¥ HTTP ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ãƒãƒƒãƒ”ãƒ³ã‚°
   - ç†ç”±: å…¨ã‚¨ãƒ©ãƒ¼ãŒ 400 ã§è¿”ã•ã‚Œã‚‹å•é¡Œ

3. **Order ä½œæˆã®å†ªç­‰æ€§**
   - Idempotency Key æ©Ÿèƒ½å®Ÿè£…
   - ç†ç”±: é‡è¤‡æ³¨æ–‡é˜²æ­¢ãŒæœªå®Ÿè£…

**âš ï¸ High ãƒ¬ãƒ™ãƒ«ï¼ˆæ¨å¥¨ä¿®æ­£ï¼‰**:

4. **DynamoDB Transactions é©ç”¨**

   - åœ¨åº«æ¸›ç®—ã¨æ³¨æ–‡ä¿å­˜ã®åŸå­æ€§ä¿è¨¼
   - ç†ç”±: éƒ¨åˆ†å¤±æ•—çŠ¶æ…‹ã®å›é¿

5. **ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹ã®å®‰å…¨åŒ–**
   - å†ªç­‰æ€§ãƒã‚§ãƒƒã‚¯ä»˜ããƒªãƒˆãƒ©ã‚¤å®Ÿè£…
   - ç†ç”±: å±é™ºãªæ“ä½œã®é‡è¤‡å®Ÿè¡Œé˜²æ­¢

**ğŸ“ Medium ãƒ¬ãƒ™ãƒ«ï¼ˆæ™‚é–“ãŒã‚ã‚Œã°ï¼‰**:

6. **ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼å®Ÿè£…**
   - DynamoDB æ¥ç¶šã‚¨ãƒ©ãƒ¼æ™‚ã®éšœå®³æ‹¡æ•£é˜²æ­¢
   - ç†ç”±: ã‚·ã‚¹ãƒ†ãƒ å®‰å®šæ€§å‘ä¸Š

#### 10. **å®Ÿè£…ã®å‰ææ¡ä»¶ã¨åˆ¶ç´„**

**æŠ€è¡“çš„åˆ¶ç´„**:

- DynamoDB Local ç’°å¢ƒã§ã®é–‹ç™ºï¼ˆæœ¬ç•ªã¯ AWS DynamoDBï¼‰
- Single Table Design ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç¶­æŒ
- Clean Architecture åŸå‰‡ã®éµå®ˆ
- Go 1.21+ã®æ©Ÿèƒ½æ´»ç”¨

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶**:

- API å¿œç­”æ™‚é–“: 95 ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ« < 500ms
- ä¸¦è¡Œæ³¨æ–‡å‡¦ç†: 80%ä»¥ä¸Šã®æˆåŠŸç‡ç¶­æŒ
- E2E ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“: < 30 ç§’

**å¯è¦³æ¸¬æ€§è¦ä»¶**:

- æ§‹é€ åŒ–ãƒ­ã‚°ï¼ˆJSON å½¢å¼ï¼‰
- ã‚¨ãƒ©ãƒ¼ç¨®åˆ¥ã®è©³ç´°æƒ…å ±
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹å–å¾—å¯èƒ½æ€§

#### 12. **ãƒªã‚¹ã‚¯ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆï¼ˆPhase 4ï¼‰**

**ğŸš¨ é«˜ãƒªã‚¹ã‚¯ï¼ˆå³åº§ã«å¯¾å¿œãŒå¿…è¦ï¼‰**:

| ãƒªã‚¹ã‚¯é …ç›®             | å½±éŸ¿åº¦ | ç™ºç”Ÿç¢ºç‡ | å¯¾ç­–                             | æœŸé™   |
| ---------------------- | ------ | -------- | -------------------------------- | ------ |
| åœ¨åº«ç«¶åˆå•é¡Œ           | é«˜     | 100%     | DynamoDB Conditional Writes å®Ÿè£… | Day 15 |
| é‡è¤‡æ³¨æ–‡               | é«˜     | 80%      | Idempotency Key å®Ÿè£…             | Day 16 |
| ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¸çµ±ä¸€ | ä¸­     | 100%     | æ§‹é€ åŒ–ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹           | Day 15 |

**âš ï¸ ä¸­ãƒªã‚¹ã‚¯ï¼ˆè¨ˆç”»çš„ã«å¯¾å¿œï¼‰**:

| ãƒªã‚¹ã‚¯é …ç›®         | å½±éŸ¿åº¦ | ç™ºç”Ÿç¢ºç‡ | å¯¾ç­–                       | æœŸé™     |
| ------------------ | ------ | -------- | -------------------------- | -------- |
| éƒ¨åˆ†å¤±æ•—çŠ¶æ…‹       | é«˜     | 40%      | DynamoDB Transactions é©ç”¨ | Day 17   |
| DynamoDB æ¥ç¶šéšœå®³  | ä¸­     | 30%      | ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼å®Ÿè£…   | Phase å¾Œ |
| ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ£åŒ– | ä¸­     | 50%      | ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆå¼·åŒ–     | Day 17   |

**ğŸ“ ä½ãƒªã‚¹ã‚¯ï¼ˆç›£è¦–ã®ã¿ï¼‰**:

- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å¿˜ã‚Œ â†’ ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆæ”¹å–„ã§å¯¾å¿œ
- é–‹ç™ºç’°å¢ƒå›ºæœ‰ã®å•é¡Œ â†’ æœ¬ç•ªç’°å¢ƒãƒ†ã‚¹ãƒˆã§æ¤œè¨¼
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°æ¼ã‚Œ â†’ Phase 4 å®Œäº†æ™‚ã«ä¸€æ‹¬ç¢ºèª

#### 13. **æŠ€è¡“çš„è² å‚µã®ç®¡ç†**

**ç¾åœ¨ã®æŠ€è¡“çš„è² å‚µ**:

1. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ä¸€è²«æ€§ä¸è¶³**

   - è² å‚µãƒ¬ãƒ™ãƒ«: é«˜
   - è§£æ±ºã‚¿ã‚¤ãƒŸãƒ³ã‚°: Phase 4 å¿…é ˆ
   - å½±éŸ¿: API ã®ä¿¡é ¼æ€§ã€ãƒ‡ãƒãƒƒã‚°å›°é›£æ€§

2. **å†ªç­‰æ€§ã®æœªå®Ÿè£…**

   - è² å‚µãƒ¬ãƒ™ãƒ«: é«˜
   - è§£æ±ºã‚¿ã‚¤ãƒŸãƒ³ã‚°: Phase 4 å¿…é ˆ
   - å½±éŸ¿: é‡è¤‡å‡¦ç†ã€ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§

3. **ãƒ­ã‚°å‡ºåŠ›ã®æ§‹é€ åŒ–ä¸è¶³**

   - è² å‚µãƒ¬ãƒ™ãƒ«: ä¸­
   - è§£æ±ºã‚¿ã‚¤ãƒŸãƒ³ã‚°: Phase 4 ã§éƒ¨åˆ†æ”¹å–„
   - å½±éŸ¿: é‹ç”¨ç›£è¦–ã®å›°é›£æ€§

4. **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã®åã‚Š**
   - è² å‚µãƒ¬ãƒ™ãƒ«: ä¸­
   - è§£æ±ºã‚¿ã‚¤ãƒŸãƒ³ã‚°: ç¶™ç¶šçš„æ”¹å–„
   - å½±éŸ¿: ãƒã‚°æ¤œå‡ºèƒ½åŠ›

**è¨±å®¹å¯èƒ½ãªè² å‚µ**:

- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼ˆMVP æ®µéšã§ã¯ä¸è¦ï¼‰
- è©³ç´°ãªãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ï¼ˆåŸºæœ¬æ©Ÿèƒ½å®‰å®šå¾Œï¼‰
- è¤‡é›‘ãªãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆè¦ä»¶ãŒå›ºã¾ã£ã¦ã‹ã‚‰ï¼‰

#### 14. **å“è³ªã‚²ãƒ¼ãƒˆã®å®šç¾©**

**Phase 4 å®Œäº†ã®å¿…é ˆæ¡ä»¶**:

âœ… **æ©Ÿèƒ½å“è³ª**:

- [ ] å…¨ E2E ãƒ†ã‚¹ãƒˆãŒ pass ã™ã‚‹
- [ ] ä¸¦è¡Œå‡¦ç†ãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡
- [ ] å†ªç­‰æ€§ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã™ã‚‹
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ãŒè¦ä»¶ã‚’æº€ãŸã™

âœ… **ã‚³ãƒ¼ãƒ‰å“è³ª**:

- [ ] golintã€go vetã€gofmt ãŒ pass
- [ ] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ > 80%
- [ ] ã‚µã‚¤ã‚¯ãƒ­ãƒãƒ†ã‚£ãƒƒã‚¯è¤‡é›‘åº¦ < 10
- [ ] æ§‹é€ åŒ–ãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚Œã‚‹

âœ… **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå“è³ª**:

- [ ] API ä»•æ§˜æ›¸ãŒæœ€æ–°
- [ ] README.md ãŒæ›´æ–°æ¸ˆã¿
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ä½œæˆ
- [ ] é‹ç”¨æ‰‹é †æ›¸ä½œæˆ

#### 11. **Phase 4 ã§ã®æŠ€è¡“çš„åˆ¤æ–­åŸºæº–**

**å®Ÿè£…ã‚’é€²ã‚ã‚‹åŸºæº–**:

- æ—¢å­˜ã® E2E ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã“ã¨
- æ–°æ©Ÿèƒ½è¿½åŠ æ™‚ã¯å¿…ãšãƒ†ã‚¹ãƒˆã‚‚è¿½åŠ 
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ”¹å–„ãŒå…ˆè¡Œ

**å®Ÿè£…ã‚’å¾Œå›ã—ã«ã™ã‚‹åŸºæº–**:

- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼ˆæ©Ÿèƒ½å®Œæˆå¾Œï¼‰
- è©³ç´°ãªãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ï¼ˆåŸºæœ¬æ©Ÿèƒ½å®‰å®šå¾Œï¼‰
- UI/UX æ”¹å–„ï¼ˆAPI å®‰å®šå¾Œï¼‰

---

---

## Phase 1: Foundationï¼ˆç›®æ¨™æœŸé–“: 1 é€±é–“ï¼‰

### ğŸ¯ ç›®æ¨™

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åŸºç›¤ã¨ãªã‚‹ç’°å¢ƒæ§‹ç¯‰ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤å®Ÿè£…

### Sprint 1.1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ï¼ˆ2 æ—¥ç›®æ¨™ï¼‰

#### Day 1: ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

- [x] **Task 1.1.1**: Go module åˆæœŸåŒ–
  ```bash
  go mod init dynamo-modeling
  ```
- [x] **Task 1.1.2**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ä½œæˆ
  ```
  cmd/server/main.go
  internal/domain/entity/
  internal/domain/value/
  internal/domain/repository/
  internal/usecase/
  internal/adapter/controller/
  internal/adapter/presenter/
  internal/adapter/repository/
  internal/handler/
  internal/infrastructure/
  api/openapi.yml
  docker-compose.yml
  Makefile
  ```
- [x] **Task 1.1.3**: åŸºæœ¬ä¾å­˜é–¢ä¿‚è¿½åŠ 
  ```bash
  go get github.com/labstack/echo/v4
  go get github.com/aws/aws-sdk-go-v2/service/dynamodb
  go get github.com/stretchr/testify
  ```
- [x] **Task 1.1.4**: Docker Compose è¨­å®š
  ```yaml
  services:
    dynamodb-local:
      image: amazon/dynamodb-local:2.4.0
      ports:
        - "8000:8000"
      command: ["-jar", "DynamoDBLocal.jar", "-inMemory", "-port", "8000"]
  ```

#### Day 2: DynamoDB æ¥ç¶šç¢ºèª

- [x] **Task 1.1.5**: DynamoDB Local èµ·å‹•ç¢ºèª
- [x] **Task 1.1.6**: Go ã‹ã‚‰ DynamoDB Local æ¥ç¶šãƒ†ã‚¹ãƒˆ
- [x] **Task 1.1.7**: ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ

### Sprint 1.2: ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤å®Ÿè£…ï¼ˆ3 æ—¥ç›®æ¨™ï¼‰

#### Day 3: å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå®Ÿè£…

- [x] **Task 1.2.1**: åŸºæœ¬å‹å®šç¾©
  ```go
  type CustomerID string
  type ProductID string
  type OrderID string
  type Money int // cents
  ```
- [x] **Task 1.2.2**: Email å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
  ```go
  type Email struct { value string }
  func NewEmail(email string) (Email, error)
  ```
- [x] **Task 1.2.3**: Money å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
  ```go
  type Money struct { cents int }
  func NewMoney(amount int) (Money, error)
  func (m Money) Add(other Money) Money
  ```
- [x] **Task 1.2.4**: å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å˜ä½“ãƒ†ã‚¹ãƒˆ

#### Day 4: ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®Ÿè£…

- [x] **Task 1.2.5**: Customer ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
  ```go
  type Customer struct {
    id CustomerID
    email Email
    name string
    // ...
  }
  func NewCustomer(...) *Customer
  ```
- [x] **Task 1.2.6**: Product ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
- [x] **Task 1.2.7**: Order ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ï¼ˆåŸºæœ¬æ§‹é€ ï¼‰
- [x] **Task 1.2.8**: ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®å˜ä½“ãƒ†ã‚¹ãƒˆ

#### Day 5: ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

- [x] **Task 1.2.9**: CustomerRepository ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
  ```go
  type CustomerRepository interface {
    Save(ctx context.Context, customer *Customer) error
    FindByID(ctx context.Context, id CustomerID) (*Customer, error)
    FindByEmail(ctx context.Context, email Email) (*Customer, error)
  }
  ```
- [x] **Task 1.2.10**: ProductRepository ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- [x] **Task 1.2.11**: OrderRepository ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- [x] **Task 1.2.12**: ~~ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰~~ â†’ å‰Šé™¤æ¸ˆã¿ï¼ˆClean Architecture é•åã®ãŸã‚ï¼‰

## Phase 2: Infrastructureï¼ˆç›®æ¨™æœŸé–“: 1 é€±é–“ï¼‰

### ğŸ¯ ç›®æ¨™

DynamoDB æ¥ç¶šã¨ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–æ©Ÿèƒ½ã®å®Ÿè£…

### Sprint 2.1: DynamoDB ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆ2 æ—¥ç›®æ¨™ï¼‰

#### Day 6: ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆå®Ÿè£…

- [x] **Task 2.1.1**: DynamoDB ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
  ```bash
  aws dynamodb create-table --table-name OnlineShop \
    --attribute-definitions AttributeName=PK,AttributeType=S AttributeName=SK,AttributeType=S \
    --key-schema AttributeName=PK,KeyType=HASH AttributeName=SK,KeyType=RANGE \
    --endpoint-url http://localhost:8000
  ```
- [x] **Task 2.1.2**: GSI1, GSI2 ä½œæˆ
- [x] **Task 2.1.3**: ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã®è‡ªå‹•åŒ–ï¼ˆMakefileï¼‰

#### Day 7: AWS SDK è¨­å®š

- [x] **Task 2.1.4**: DynamoDB ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®šï¼ˆguregu/dynamo ä½¿ç”¨ï¼‰
  ```go
  cfg, err := config.LoadDefaultConfig(ctx,
    config.WithEndpointResolver(aws.EndpointResolverFunc(func(service, region string) (aws.Endpoint, error) {
      return aws.Endpoint{URL: "http://localhost:8000"}, nil
    })))
  ```
- [x] **Task 2.1.5**: è¨­å®šã®ç’°å¢ƒå¤‰æ•°åŒ–
- [x] **Task 2.1.6**: æ¥ç¶šãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å®Ÿè£…

### Sprint 2.2: ãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…ï¼ˆ3 æ—¥ç›®æ¨™ï¼‰

#### Day 8: ãƒ‡ãƒ¼ã‚¿ãƒãƒƒãƒ‘ãƒ¼å®Ÿè£…

- [x] **Task 2.2.1**: Customer ãƒ‡ãƒ¼ã‚¿ãƒãƒƒãƒ‘ãƒ¼ï¼ˆCustomerItem struct ä½¿ç”¨ï¼‰
  ```go
  func CustomerToItem(customer *entity.Customer) (map[string]types.AttributeValue, error)
  func ItemToCustomer(item map[string]types.AttributeValue) (*entity.Customer, error)
  ```
- [ ] **Task 2.2.2**: Product ãƒ‡ãƒ¼ã‚¿ãƒãƒƒãƒ‘ãƒ¼
- [ ] **Task 2.2.3**: ãƒãƒƒãƒ‘ãƒ¼ã®å˜ä½“ãƒ†ã‚¹ãƒˆ

#### Day 9: Customer ãƒªãƒã‚¸ãƒˆãƒª

- [x] **Task 2.2.4**: DynamoCustomerRepository å®Ÿè£…ï¼ˆguregu/dynamo ä½¿ç”¨ï¼‰
  ```go
  func (r *DynamoCustomerRepository) Save(ctx context.Context, customer *entity.Customer) error
  func (r *DynamoCustomerRepository) FindByID(ctx context.Context, id value.CustomerID) (*entity.Customer, error)
  ```
- [x] **Task 2.2.5**: Customer ãƒªãƒã‚¸ãƒˆãƒªã®çµ±åˆãƒ†ã‚¹ãƒˆ

#### Day 10: Product/Order ãƒªãƒã‚¸ãƒˆãƒª

- [ ] **Task 2.2.6**: DynamoProductRepository å®Ÿè£…
- [ ] **Task 2.2.7**: DynamoOrderRepository å®Ÿè£…ï¼ˆåŸºæœ¬æ©Ÿèƒ½ï¼‰
- [x] **Task 2.2.8**: å…¨ãƒªãƒã‚¸ãƒˆãƒªã®çµ±åˆãƒ†ã‚¹ãƒˆ
  ```go
  // integration_test.go ã§ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆå®Ÿè£…æ¸ˆã¿
  // Customerç™»éŒ² â†’ Productä½œæˆ â†’ Orderä½œæˆã®ä¸€é€£ãƒ•ãƒ­ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆ
  // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆ100ä»¶ä¸€æ‹¬æ“ä½œï¼‰ã‚‚å«ã‚€
  ```

**ğŸ¯ ç¾åœ¨åœ°**: Sprint 2.2 å®Œäº†ï¼ æ¬¡ã¯ Sprint 3.1ï¼ˆOpenAPI & åŸºæœ¬ API å®Ÿè£…ï¼‰

## Phase 3: API Layerï¼ˆç›®æ¨™æœŸé–“: 1 é€±é–“ï¼‰

### ğŸ¯ ç›®æ¨™

REST API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨æ¥­å‹™ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®å®Ÿè£…

### Sprint 3.1: OpenAPI & åŸºæœ¬ APIï¼ˆ2 æ—¥ç›®æ¨™ï¼‰

#### Day 11: OpenAPI ä»•æ§˜å®šç¾©

- [x] **Task 3.1.1**: OpenAPI ä»•æ§˜æ›¸ä½œæˆ
  ```yaml
  openapi: 3.1.0
  info:
    title: Online Shop API
    version: 1.0.0
  paths:
    /customers:
      post: ...
      get: ...
    /products:
      post: ...
      get: ...
  ```
- [x] **Task 3.1.2**: oapi-codegen è¨­å®š
  ```yaml
  # oapi-codegen.config.yaml
  package: openapi
  generate:
    models: true
    echo-server: true
    embedded-spec: true
  output: internal/adapter/openapi/generated.go
  ```
- [x] **Task 3.1.3**: API å‹ã¨ã‚µãƒ¼ãƒãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ç”Ÿæˆ
  ```go
  // ç”Ÿæˆã•ã‚ŒãŸEchoç”¨ServerInterface
  type ServerInterface interface {
    ListCustomers(ctx echo.Context, params ListCustomersParams) error
    CreateCustomer(ctx echo.Context) error
    // ... 15ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®šç¾©æ¸ˆã¿
  }
  ```

#### Day 12: åŸºæœ¬ CRUD API

- [x] **Task 3.1.4**: Customer CRUD API å®Ÿè£…
  ```go
  func (h *APIHandler) CreateCustomer(ctx echo.Context) error
  func (h *APIHandler) GetCustomer(ctx echo.Context, customerId string) error
  func (h *APIHandler) ListCustomers(ctx echo.Context, params openapi.ListCustomersParams) error
  func (h *APIHandler) UpdateCustomer(ctx echo.Context, customerId string) error
  func (h *APIHandler) DeleteCustomer(ctx echo.Context, customerId string) error
  ```
- [x] **Task 3.1.5**: Product CRUD API å®Ÿè£…
  ```go
  func (h *APIHandler) CreateProduct(ctx echo.Context) error
  func (h *APIHandler) GetProduct(ctx echo.Context, productId string) error
  func (h *APIHandler) ListProducts(ctx echo.Context, params openapi.ListProductsParams) error
  func (h *APIHandler) UpdateProduct(ctx echo.Context, productId string) error
  func (h *APIHandler) DeleteProduct(ctx echo.Context, productId string) error
  ```
- [x] **Task 3.1.6**: Order CRUD API å®Ÿè£…
  ```go
  func (h *APIHandler) CreateOrder(ctx echo.Context) error
  func (h *APIHandler) GetOrder(ctx echo.Context, orderId string) error
  func (h *APIHandler) ListOrders(ctx echo.Context, params openapi.ListOrdersParams) error
  func (h *APIHandler) UpdateOrderStatus(ctx echo.Context, orderId string) error
  func (h *APIHandler) GetCustomerOrders(ctx echo.Context, customerId string, params openapi.GetCustomerOrdersParams) error
  ```
- [x] **Task 3.1.7**: Echo Server & Middleware è¨­å®š
  ```go
  e := echo.New()
  e.Use(middleware.Logger())
  e.Use(middleware.Recover())
  e.Use(middleware.CORS())
  openapi.RegisterHandlers(e, apiHandler)
  ```
- [x] **Task 3.1.8**: åŸºæœ¬ API ã®å‹•ä½œç¢ºèª
  ```bash
  # ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ãƒ†ã‚¹ãƒˆæˆåŠŸ
  curl http://localhost:8080/customers â†’ [ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿] âœ…
  curl -X POST http://localhost:8080/customers -d '{"name":"Test","email":"test@example.com"}' â†’ 201 Created âœ…
  # å…¨15ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆåŸºæœ¬å‹•ä½œç¢ºèªæ¸ˆã¿
  ```

### Sprint 3.2: æ¥­å‹™ APIï¼ˆ3 æ—¥ç›®æ¨™ï¼‰

#### Day 13: ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤å®Ÿè£…

- [x] **Task 3.2.1**: CreateCustomerUseCase å®Ÿè£…
  ```go
  type CreateCustomerUseCase struct {
    customerRepo repository.CustomerRepository
  }
  func (uc *CreateCustomerUseCase) Execute(ctx context.Context, cmd CreateCustomerCommand) (*Customer, error)
  ```
- [x] **Task 3.2.2**: CreateProductUseCase å®Ÿè£…
- [x] **Task 3.2.3**: ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®å˜ä½“ãƒ†ã‚¹ãƒˆ

#### Day 14: æ³¨æ–‡æ©Ÿèƒ½å®Ÿè£…

- [x] **Task 3.2.4**: CreateOrderUseCase å®Ÿè£…
- [x] **Task 3.2.5**: GetCustomerOrdersUseCase å®Ÿè£…ï¼ˆGSI2 ä½¿ç”¨ï¼‰
- [x] **Task 3.2.6**: æ³¨æ–‡ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…

#### Day 15: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»E2E ãƒ†ã‚¹ãƒˆ

- [x] **Task 3.2.7**: çµ±ä¸€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å®Ÿè£…
- [x] **Task 3.2.8**: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£…
- [x] **Task 3.2.9**: E2E ãƒ†ã‚¹ãƒˆå®Ÿè£…

## Phase 4: Quality & Documentationï¼ˆç›®æ¨™æœŸé–“: 3 æ—¥ï¼‰

### ğŸ¯ ç›®æ¨™

E2E ãƒ†ã‚¹ãƒˆã§ç™ºè¦‹ã•ã‚ŒãŸ**ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãªå“è³ªèª²é¡Œ**ã®è§£æ±ºã¨åŸºæœ¬çš„ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™

#### é‡è¦: ç¾åœ¨ã®å„ªå…ˆé †ä½

1. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»å†ªç­‰æ€§ãƒ»ç«¶åˆåˆ¶å¾¡** (Critical)
2. **åŸºæœ¬çš„ãªå“è³ªå‘ä¸Šãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ** (Important)

### ğŸ“Š Sprint 4.1: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»å†ªç­‰æ€§æ”¹å–„ï¼ˆ3 æ—¥ï¼‰

#### Day 15: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°çµ±ä¸€åŒ–

**é‡è¦**: E2E ãƒ†ã‚¹ãƒˆã§ç™ºè¦‹ã•ã‚ŒãŸå•é¡Œã¸ã®å¯¾ç­–ã‚’æœ€å„ªå…ˆã§å®Ÿè£…

- [ ] **Task 4.1.1**: æ§‹é€ åŒ–ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å®Ÿè£…

  - APIError æ§‹é€ ä½“å®šç¾©ï¼ˆCode, Message, Details, RetryAfterï¼‰
  - ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ã‹ã‚‰ HTTP ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚°é–¢æ•°
  - Presenter å±¤ã§ã®ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹çµ±ä¸€åŒ–

- [ ] **Task 4.1.2**: åœ¨åº«ç®¡ç†ç«¶åˆåˆ¶å¾¡å®Ÿè£…

  - DynamoDB Conditional Writes å®Ÿè£…
  - product.ReserveStock()ã§ã®æ¥½è¦³çš„ãƒ­ãƒƒã‚¯è¿½åŠ 
  - ConditionalCheckFailedException å‡¦ç†

- [ ] **Task 4.1.3**: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å˜ä½“ãƒ†ã‚¹ãƒˆ
  - ä¸¦è¡Œåœ¨åº«æ›´æ–°ã§ã® Conflict ã‚¨ãƒ©ãƒ¼ãƒ†ã‚¹ãƒˆ
  - HTTP ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ
  - ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ãƒ†ã‚¹ãƒˆ

#### Day 16: å†ªç­‰æ€§ãƒ»ãƒªãƒˆãƒ©ã‚¤å®Ÿè£…

- [ ] **Task 4.2.1**: Idempotency Key æ©Ÿèƒ½å®Ÿè£…

  - IdempotencyService interface å®šç¾©
  - DynamoDB ãƒ™ãƒ¼ã‚¹ã®ã‚­ãƒ¼ç®¡ç†å®Ÿè£…
  - 24 æ™‚é–“ TTL è¨­å®š

- [ ] **Task 4.2.2**: Order ä½œæˆã®å†ªç­‰æ€§å®Ÿè£…

  - CreateOrderCommand ã« IdempotencyKey è¿½åŠ 
  - ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒãƒƒã‚·ãƒ¥ãƒ™ãƒ¼ã‚¹ã®ã‚­ãƒ¼ç”Ÿæˆ
  - å‡¦ç†æ¸ˆã¿ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®çµæœè¿”å´

- [ ] **Task 4.2.3**: ãƒªãƒˆãƒ©ã‚¤å®‰å…¨æ€§ã®æ”¹å–„
  - å†ªç­‰æ€§ãƒã‚§ãƒƒã‚¯ä»˜ããƒªãƒˆãƒ©ã‚¤å®Ÿè£…
  - ã‚¨ã‚¯ã‚¹ãƒãƒãƒ³ã‚·ãƒ£ãƒ«ãƒãƒƒã‚¯ã‚ªãƒ•
  - ãƒªãƒˆãƒ©ã‚¤å¯èƒ½ã‚¨ãƒ©ãƒ¼ã®åˆ†é¡

#### Day 17: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ»ãƒ†ã‚¹ãƒˆå¼·åŒ–

- [ ] **Task 4.3.1**: DynamoDB Transactions é©ç”¨

  - TransactWriteItems ä½¿ç”¨ã§ã®æ³¨æ–‡ä½œæˆ
  - åœ¨åº«æ¸›ç®—ã¨æ³¨æ–‡ä¿å­˜ã®åŸå­æ€§ä¿è¨¼
  - ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¤±æ•—æ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

- [ ] **Task 4.3.2**: E2E ãƒ†ã‚¹ãƒˆæ‹¡å¼µ

  - å†ªç­‰æ€§ãƒ†ã‚¹ãƒˆè¿½åŠ 
  - ä¸¦è¡Œå‡¦ç†ã§ã®æ•´åˆæ€§ãƒ†ã‚¹ãƒˆå¼·åŒ–
  - ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ¤œè¨¼ãƒ†ã‚¹ãƒˆ

- [ ] **Task 4.3.3**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™æ¸¬å®š
  - ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ã® 95 ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«æ¸¬å®š
  - ä¸¦è¡Œå‡¦ç†æˆåŠŸç‡ã®æ¸¬å®š
  - ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡ã®ç›£è¦–

### ğŸ“Š Sprint 3.1 å®Œäº†ã‚µãƒãƒªãƒ¼

**å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½**:

- âœ… Echo v4 Framework çµ±åˆ
- âœ… OpenAPI 3.1 ä»•æ§˜æ›¸å®Œæˆï¼ˆCustomer, Product, Order å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰
- âœ… oapi-codegen è¨­å®šãƒ»ã‚³ãƒ¼ãƒ‰ç”Ÿæˆï¼ˆEcho ç”¨ ServerInterfaceï¼‰
- âœ… APIHandler å®Ÿè£…ï¼ˆå…¨ 15 ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰
- âœ… ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ãƒ»ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãƒ†ã‚¹ãƒˆæˆåŠŸ
- âœ… JSON request/response å‡¦ç†
- âœ… ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢è¨­å®šï¼ˆCORS, Logger, Recoverï¼‰

**æŠ€è¡“çš„æˆæœ**:

- Echo v4 ã§ã® OpenAPI-first é–‹ç™ºãƒ•ãƒ­ãƒ¼ç¢ºç«‹
- å‹å®‰å…¨ãª API å®Ÿè£…ï¼ˆOpenAPI ä»•æ§˜ã‹ã‚‰ã®è‡ªå‹•ç”Ÿæˆï¼‰
- RESTful API è¨­è¨ˆï¼ˆ15 ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæ­£å¸¸å‹•ä½œï¼‰
- Graceful Shutdown ã‚µãƒ¼ãƒãƒ¼å®Ÿè£…

**å‹•ä½œç¢ºèª**:

```bash
# ã‚µãƒ¼ãƒãƒ¼èµ·å‹•æˆåŠŸ (Echo v4, port 8080)
# GET /customers â†’ ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸ
# POST /customers â†’ JSON request/responseæˆåŠŸ
# å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆåŸºæœ¬å‹•ä½œç¢ºèªæ¸ˆã¿
```

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ç¢ºå®š

```
è¨€èª: Go 1.22
Web Framework: Echo v4
DB: DynamoDB (Local)
ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ: oapi-codegen
ãƒ†ã‚¹ãƒˆ: testify + gomock
ã‚³ãƒ³ãƒ†ãƒŠ: Docker + docker-compose
AWS SDK: aws-sdk-go-v2
```

## é€²æ—ç®¡ç†

### ãƒ‡ã‚¤ãƒªãƒ¼ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ

- [ ] ãã®æ—¥ã®ã‚¿ã‚¹ã‚¯ãŒå®Œäº†ã—ãŸã‹
- [ ] ãƒ†ã‚¹ãƒˆãŒé€šã£ã¦ã„ã‚‹ã‹
- [ ] è¨­è¨ˆåŸå‰‡ã‹ã‚‰é€¸è„±ã—ã¦ã„ãªã„ã‹
- [ ] ç¿Œæ—¥ã®ã‚¿ã‚¹ã‚¯ãŒæ˜ç¢ºã‹

### ã‚¦ã‚£ãƒ¼ã‚¯ãƒªãƒ¼ãƒ¬ãƒ“ãƒ¥ãƒ¼

- [ ] Phase ç›®æ¨™é”æˆåº¦
- [ ] å­¦ç¿’å†…å®¹ã®æŒ¯ã‚Šè¿”ã‚Š
- [ ] æ¬¡ Phase ã®æº–å‚™ç¢ºèª
- [ ] ãƒªã‚¹ã‚¯ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆæ›´æ–°

### å®Œäº†æ¡ä»¶

1. âœ… å…¨æ©Ÿèƒ½ãŒ DynamoDB Local ã§å‹•ä½œ
2. âœ… ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ 80%ä»¥ä¸Š
3. âœ… OpenAPI ä»•æ§˜æ›¸å®Œæˆ
4. âœ… Clean Architecture ã®åŸå‰‡éµå®ˆ
5. âœ… å­¦ç¿’ç›®æ¨™é”æˆï¼ˆã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ç†è§£ç­‰ï¼‰

## ç·Šæ€¥æ™‚å¯¾å¿œ

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é…å»¶æ™‚

1. **1 æ—¥é…å»¶**: ã‚¿ã‚¹ã‚¯ã®å„ªå…ˆåº¦è¦‹ç›´ã—ã€ä¸è¦æ©Ÿèƒ½ã®å‰Šé™¤
2. **3 æ—¥é…å»¶**: Phase scope ã®ç¸®å°æ¤œè¨
3. **1 é€±é–“é…å»¶**: MVP å†å®šç¾©ã€Phase 4 ã®ç°¡ç´ åŒ–

### æŠ€è¡“çš„èª²é¡Œç™ºç”Ÿæ™‚

1. **DynamoDB è¨­è¨ˆå•é¡Œ**: ä¸€æ™‚çš„ã«å˜ç´”ãªè¨­è¨ˆã«å¤‰æ›´
2. **Go è¨€èªç†è§£ä¸è¶³**: ã‚ˆã‚Šç°¡å˜ãªå®Ÿè£…æ–¹æ³•ã«å¤‰æ›´
3. **Clean Architecture ç†è§£ä¸è¶³**: ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€ ã®ç°¡ç´ åŒ–

### ãƒªã‚½ãƒ¼ã‚¹ä¸è¶³æ™‚

- **æ™‚é–“ä¸è¶³**: è‡ªå‹•ãƒ†ã‚¹ãƒˆã‚’æ‰‹å‹•ãƒ†ã‚¹ãƒˆã«å¤‰æ›´
- **çŸ¥è­˜ä¸è¶³**: å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ»ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰å„ªå…ˆå‚ç…§
- **ç’°å¢ƒä¸è¶³**: ã‚¯ãƒ©ã‚¦ãƒ‰ç’°å¢ƒã®åˆ©ç”¨æ¤œè¨

## æ‹¡å¼µå€™è£œãƒ‰ãƒ¡ã‚¤ãƒ³

### Phase 5: åœ¨åº«ãƒ»é…é€ãƒ»æ±ºæ¸ˆæ‹¡å¼µï¼ˆç›®æ¨™æœŸé–“: 1 é€±é–“ï¼‰

ç¾åœ¨ã®åŸºæœ¬ 3 ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆCustomer, Product, Orderï¼‰ã«åŠ ãˆã¦ã€ä»¥ä¸‹ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šå®Ÿç”¨çš„ãªã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚·ãƒ§ãƒƒãƒ—ã‚’æ§‹ç¯‰ã§ãã‚‹ã®ã ã€‚

#### Warehouseï¼ˆå€‰åº«ãƒ»åœ¨åº«ç®¡ç†ï¼‰

```go
// åœ¨åº«ç®¡ç†ã®å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
type WarehouseID    = Branded[string, "WarehouseID"]
type StockQuantity  = Branded[int, "StockQuantity"]
type ReorderLevel   = Branded[int, "ReorderLevel"]

// åœ¨åº«ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
type Stock struct {
    warehouseID WarehouseID
    productID   ProductID
    quantity    StockQuantity
    reorderLevel ReorderLevel
    location    string // å€‰åº«å†…ã®å ´æ‰€
}

// å€‰åº«ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
type Warehouse struct {
    id       WarehouseID
    name     string
    address  string
    isActive bool
}
```

**å®Ÿè£…å„ªå…ˆåº¦**: é«˜ï¼ˆåœ¨åº«åˆ‡ã‚Œç®¡ç†ã¯å¿…é ˆæ©Ÿèƒ½ï¼‰
**DynamoDB ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³**:

- PK: `WAREHOUSE#{warehouseID}`, SK: `STOCK#{productID}`
- GSI1: `PRODUCT#{productID}`, SK: `WAREHOUSE#{warehouseID}` ï¼ˆå•†å“åˆ¥åœ¨åº«æ¤œç´¢ï¼‰
- GSI2: `STOCK#LOW`, SK: quantity ï¼ˆåœ¨åº«åˆ‡ã‚Œã‚¢ãƒ©ãƒ¼ãƒˆç”¨ï¼‰

#### Shipmentï¼ˆé…é€ç®¡ç†ï¼‰

```go
// é…é€ã®å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
type ShipmentID     = Branded[string, "ShipmentID"]
type TrackingNumber = Branded[string, "TrackingNumber"]
type ShippingFee    = Money

// é…é€çŠ¶æ…‹
type ShipmentStatus int
const (
    ShipmentPending ShipmentStatus = iota
    ShipmentPicked
    ShipmentShipped
    ShipmentDelivered
    ShipmentReturned
)

// é…é€ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
type Shipment struct {
    id            ShipmentID
    orderID       OrderID
    trackingNumber TrackingNumber
    status        ShipmentStatus
    shippingFee   ShippingFee
    estimatedDelivery time.Time
    actualDelivery    *time.Time
}
```

**å®Ÿè£…å„ªå…ˆåº¦**: ä¸­ï¼ˆæ³¨æ–‡ã¨ã®é€£æºãŒé‡è¦ï¼‰
**DynamoDB ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³**:

- PK: `SHIPMENT#{shipmentID}`, SK: `METADATA`
- GSI1: `ORDER#{orderID}`, SK: `SHIPMENT#{shipmentID}`
- GSI2: `STATUS#{status}`, SK: estimatedDelivery ï¼ˆé…é€çŠ¶æ³åˆ¥æ¤œç´¢ï¼‰

#### Paymentï¼ˆæ±ºæ¸ˆç®¡ç†ï¼‰

```go
// æ±ºæ¸ˆã®å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
type PaymentID     = Branded[string, "PaymentID"]
type PaymentMethod = Branded[string, "PaymentMethod"]

// æ±ºæ¸ˆçŠ¶æ…‹
type PaymentStatus int
const (
    PaymentPending PaymentStatus = iota
    PaymentProcessing
    PaymentCompleted
    PaymentFailed
    PaymentRefunded
)

// æ±ºæ¸ˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
type Payment struct {
    id         PaymentID
    orderID    OrderID
    amount     Money
    method     PaymentMethod // "credit_card", "bank_transfer", etc.
    status     PaymentStatus
    processedAt *time.Time
    externalID  string // å¤–éƒ¨æ±ºæ¸ˆãƒ—ãƒ­ãƒã‚¤ãƒ€ã®ID
}
```

**å®Ÿè£…å„ªå…ˆåº¦**: é«˜ï¼ˆEC ã‚µã‚¤ãƒˆã®æ ¹å¹¹æ©Ÿèƒ½ï¼‰
**DynamoDB ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³**:

- PK: `PAYMENT#{paymentID}`, SK: `METADATA`
- GSI1: `ORDER#{orderID}`, SK: `PAYMENT#{paymentID}`
- GSI2: `STATUS#{status}`, SK: processedAt

### Phase 5 å®Ÿè£…é †åº

#### Sprint 5.1: Warehouse ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆ2 æ—¥ï¼‰

- [ ] **Task 5.1.1**: Warehouse å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ»ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®Ÿè£…
- [ ] **Task 5.1.2**: WarehouseRepository, StockRepository å®Ÿè£…
- [ ] **Task 5.1.3**: åœ¨åº«æ¸›å°‘ãƒ»è£œå……ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å®Ÿè£…
- [ ] **Task 5.1.4**: åœ¨åº«åˆ‡ã‚Œæ¤œçŸ¥æ©Ÿèƒ½å®Ÿè£…

#### Sprint 5.2: Payment ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆ2 æ—¥ï¼‰

- [ ] **Task 5.2.1**: Payment å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ»ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®Ÿè£…
- [ ] **Task 5.2.2**: PaymentRepository å®Ÿè£…
- [ ] **Task 5.2.3**: æ±ºæ¸ˆå‡¦ç†ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å®Ÿè£…ï¼ˆãƒ¢ãƒƒã‚¯ï¼‰
- [ ] **Task 5.2.4**: æ±ºæ¸ˆçŠ¶æ…‹ç®¡ç†ãƒ»å±¥æ­´æ©Ÿèƒ½å®Ÿè£…

#### Sprint 5.3: Shipment ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆ2 æ—¥ï¼‰

- [ ] **Task 5.3.1**: Shipment å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ»ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®Ÿè£…
- [ ] **Task 5.3.2**: ShipmentRepository å®Ÿè£…
- [ ] **Task 5.3.3**: é…é€çŠ¶æ³è¿½è·¡ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å®Ÿè£…
- [ ] **Task 5.3.4**: é…é€å®Œäº†é€šçŸ¥æ©Ÿèƒ½å®Ÿè£…

#### Sprint 5.4: ãƒ‰ãƒ¡ã‚¤ãƒ³çµ±åˆï¼ˆ1 æ—¥ï¼‰

- [ ] **Task 5.4.1**: Order â†’ Payment â†’ Shipment ã®çŠ¶æ…‹é€£æºå®Ÿè£…
- [ ] **Task 5.4.2**: åœ¨åº«æ¸›å°‘ â†’ æ³¨æ–‡ç¢ºå®š ã®æ•´åˆæ€§ç¢ºä¿
- [ ] **Task 5.4.3**: çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè£…
- [ ] **Task 5.4.4**: E2E ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆå®Ÿè£…

## ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### ç¾çŠ¶ã®èª²é¡Œã¨æ”¹å–„æ–¹é‡

#### ~~1. inmemory ãƒªãƒã‚¸ãƒˆãƒªã®é…ç½®å•é¡Œ~~ â†’ è§£æ±ºæ¸ˆã¿

**æ—§çŠ¶æ³**: `internal/domain/repository/inmemory_*.go` ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«é…ç½®ï¼‰
**å•é¡Œ**: Clean Architecture ã®ä¾å­˜æ€§ãƒ«ãƒ¼ãƒ«ã«é•å
**è§£æ±º**: inmemory ãƒªãƒã‚¸ãƒˆãƒªã‚’å®Œå…¨å‰Šé™¤ã—ã€DynamoDB Local çµ±ä¸€ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã«ç§»è¡Œ

#### 1. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œç’°å¢ƒã®çµ±ä¸€ âœ…

**çµ±ä¸€å¾Œã®çŠ¶æ…‹**:

**çµ±ä¸€å¾Œã®çŠ¶æ…‹**:

- å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ»ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£: ç´”ç²‹ãªå˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆå¤–éƒ¨ä¾å­˜ãªã—ï¼‰
- ãƒªãƒã‚¸ãƒˆãƒªãƒ†ã‚¹ãƒˆ: DynamoDB Local ä½¿ç”¨
- çµ±åˆãƒ†ã‚¹ãƒˆ: DynamoDB Local ä½¿ç”¨

**çµ±ä¸€æ–¹é‡**:

```bash
# é–‹ç™ºæ™‚: DynamoDB Localèµ·å‹•ãŒå‰æ
make test-unit         # ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ãƒ†ã‚¹ãƒˆï¼ˆå¤–éƒ¨ä¾å­˜ãªã—ï¼‰
make test-integration  # DynamoDB Localä½¿ç”¨ã®ãƒªãƒã‚¸ãƒˆãƒªãƒ†ã‚¹ãƒˆ

# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
make test-all     # unit + integration
```

#### 3. ãƒ†ã‚¹ãƒˆã®ãƒ”ãƒ©ãƒŸãƒƒãƒ‰æ§‹é€ 

```
      ğŸ”º E2E Tests (å°‘æ•°ãƒ»é‡è¦ãƒ‘ã‚¹)
     ğŸ”ºğŸ”º Integration Tests (é©åº¦ãƒ»å¢ƒç•Œãƒ†ã‚¹ãƒˆ)
   ğŸ”ºğŸ”ºğŸ”ºğŸ”º Unit Tests (å¤šæ•°ãƒ»ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯)
```

**å„å±¤ã®è²¬å‹™**:

- **Unit Tests**: ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆå€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ»ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ï¼‰
- **Integration Tests**: ãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ï¼ˆDynamoDB Local ä½¿ç”¨ï¼‰
- **E2E Tests**: API çµŒç”±ã®ä¸»è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚·ãƒŠãƒªã‚ª

#### 2. ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã®å®Ÿè£…

```go
// ãƒªãƒã‚¸ãƒˆãƒªã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãªã®ã§ã€ãƒ†ã‚¹ãƒˆæ™‚ã¯å·®ã—æ›¿ãˆå¯èƒ½
type CreateOrderUseCase struct {
    customerRepo repository.CustomerRepository  // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
    productRepo  repository.ProductRepository   // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
    orderRepo    repository.OrderRepository     // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
}

// çµ±åˆãƒ†ã‚¹ãƒˆæ™‚ï¼ˆDynamoDB Localä½¿ç”¨ï¼‰
func TestCreateOrderUseCase(t *testing.T) {
    // DynamoDB Localæ¥ç¶šã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½¿ç”¨
    dynamoClient := setupDynamoDBLocal(t)
    customerRepo := repository.NewDynamoCustomerRepository(dynamoClient)
    productRepo := repository.NewDynamoProductRepository(dynamoClient)
    orderRepo := repository.NewDynamoOrderRepository(dynamoClient)

    usecase := NewCreateOrderUseCase(customerRepo, productRepo, orderRepo)
    // ...
}

// çµ±åˆãƒ†ã‚¹ãƒˆæ™‚
func TestCreateOrderIntegration(t *testing.T) {
    // DynamoDB Localã‚’ä½¿ç”¨ï¼ˆå®Ÿç’°å¢ƒã«è¿‘ã„ï¼‰
    db := testutil.SetupDynamoDB(t)
    customerRepo := dynamo.NewCustomerRepository(db)
    productRepo := dynamo.NewProductRepository(db)
    orderRepo := dynamo.NewOrderRepository(db)

    usecase := NewCreateOrderUseCase(customerRepo, productRepo, orderRepo)
    // ...
}
```

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“ã®ç›®æ¨™

- **Unit Tests**: < 5 ç§’ ï¼ˆé–‹ç™ºæ™‚ã®é«˜é€Ÿãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼‰
- **Integration Tests**: < 30 ç§’ ï¼ˆDynamoDB Local ã®èµ·å‹•å«ã‚€ï¼‰
- **E2E Tests**: < 2 åˆ† ï¼ˆAPI çµŒç”±ã®è¤‡æ•°ã‚·ãƒŠãƒªã‚ªï¼‰

### ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™

- **ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤**: 90%ä»¥ä¸Š ï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å“è³ªç¢ºä¿ï¼‰
- **ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤**: 85%ä»¥ä¸Š ï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã®å“è³ªç¢ºä¿ï¼‰
- **ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼å±¤**: 70%ä»¥ä¸Š ï¼ˆä¸»è¦ãƒ‘ã‚¹ã®å‹•ä½œç¢ºèªï¼‰
- **å…¨ä½“**: 80%ä»¥ä¸Š
